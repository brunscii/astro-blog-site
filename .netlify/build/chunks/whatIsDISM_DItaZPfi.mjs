import { a as createComponent, r as renderTemplate, m as maybeRenderHead, u as unescapeHTML } from './astro/server_ogrvkZIj.mjs';
import 'kleur/colors';
import 'clsx';

const html = "<h2 id=\"what-is-dism\">What is DISM</h2>\n<p><strong>DISM</strong> is a an acronym for <strong>Deployment Image Servicing and Management</strong>. It is a command line tool for (un)installing, updating,\r\nand configuring windows features in an image. DISM can be used to capture, split, and manage .wim files, which hold windows images. What’s an image?\r\nImage files are a way of representing a disk, more on that later.</p>\n<p>DISM is a powerful utility that allows you to modify your copy of windows from the command line. This allows you to customize the operating\r\nsystem in ways that aren’t available in the system itself. I have used it to install packages, fix the operating system, and remove unwanted features.\r\nThis is a great tool shrouded in mystery so let’s take a deeper look and unwrap this windows gem.</p>\n<p>One thing I always like to do is try the command out first. In linux I would run <code>man</code> to get the manual pages but in windows you can often run the\r\ncommand with no options or with <code>/?</code> to get information on the command itself. This allows us (in most cases) to see a list of options for the command.\r\nIt also provides a syntax for how to use the command and any required arguments. This is what I got when I ran <code>DISM</code> in the windows terminal.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>Deployment Image Servicing and Management tool</span></span>\n<span class=\"line\"><span>Version: 10.0.22621.1</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DISM.exe [dism_options] {Imaging_command} [&#x3C;Imaging_arguments>]</span></span>\n<span class=\"line\"><span>DISM.exe {/Image:&#x3C;path_to_offline_image> | /Online} [dism_options] </span></span>\n<span class=\"line\"><span>        {servicing_command} [&#x3C;servicing_arguments>]</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DESCRIPTION:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DISM enumerates, installs, uninstalls, configures, and updates features</span></span>\n<span class=\"line\"><span>and packages in Windows images. The commands that are available depend </span></span>\n<span class=\"line\"><span>on the image being serviced and whether the image is offline or running.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>****</span></span>\n<span class=\"line\"><span>FFU COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Capture-Ffu            - Captures a physical disk image into a new FFU file.</span></span>\n<span class=\"line\"><span>/Apply-Ffu              - Applies an .ffu image.</span></span>\n<span class=\"line\"><span>/Split-Ffu              - Splits an existing .ffu file into multiple read-only</span></span>\n<span class=\"line\"><span>                            split FFU files.</span></span>\n<span class=\"line\"><span>/Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage </span></span>\n<span class=\"line\"><span>                            of a different size.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>WIM COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Apply-CustomDataImage  - Dehydrates files contained in the custom data image.</span></span>\n<span class=\"line\"><span>/Capture-CustomImage    - Captures customizations into a delta WIM file on a </span></span>\n<span class=\"line\"><span>                            WIMBoot system. Captured directories include all </span></span>\n<span class=\"line\"><span>                            subfolders and data.</span></span>\n<span class=\"line\"><span>/Get-WIMBootEntry       - Displays WIMBoot configuration entries for the </span></span>\n<span class=\"line\"><span>                            specified disk volume.</span></span>\n<span class=\"line\"><span>/Update-WIMBootEntry    - Updates WIMBoot configuration entry for the </span></span>\n<span class=\"line\"><span>                            specified disk volume.</span></span>\n<span class=\"line\"><span>/List-Image             - Displays a list of the files and folders in a </span></span>\n<span class=\"line\"><span>                            specified image.</span></span>\n<span class=\"line\"><span>/Delete-Image           - Deletes the specified volume image from a WIM file</span></span>\n<span class=\"line\"><span>                            that has multiple volume images.</span></span>\n<span class=\"line\"><span>/Export-Image           - Exports a copy of the specified image to another</span></span>\n<span class=\"line\"><span>                            file.</span></span>\n<span class=\"line\"><span>/Append-Image           - Adds another image to a WIM file.</span></span>\n<span class=\"line\"><span>/Capture-Image          - Captures an image of a drive into a new WIM file.</span></span>\n<span class=\"line\"><span>                            Captured directories include all subfolders and </span></span>\n<span class=\"line\"><span>                            data.</span></span>\n<span class=\"line\"><span>/Get-MountedWimInfo     - Displays information about mounted WIM images.</span></span>\n<span class=\"line\"><span>/Get-WimInfo            - Displays information about images in a WIM file.</span></span>\n<span class=\"line\"><span>/Commit-Wim             - Saves changes to a mounted WIM image.</span></span>\n<span class=\"line\"><span>/Unmount-Wim            - Unmounts a mounted WIM image.</span></span>\n<span class=\"line\"><span>/Mount-Wim              - Mounts an image from a WIM file.</span></span>\n<span class=\"line\"><span>/Remount-Wim            - Recovers an orphaned WIM mount directory.</span></span>\n<span class=\"line\"><span>/Cleanup-Wim            - Deletes resources associated with mounted WIM </span></span>\n<span class=\"line\"><span>                            images that are corrupted.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>GENERIC IMAGING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Split-Image            - Splits an existing .wim file into multiple </span></span>\n<span class=\"line\"><span>                            read-only split WIM (SWM) files.</span></span>\n<span class=\"line\"><span>/Apply-Image            - Applies an image.</span></span>\n<span class=\"line\"><span>/Get-MountedImageInfo   - Displays information about mounted WIM and VHD</span></span>\n<span class=\"line\"><span>                            images.</span></span>\n<span class=\"line\"><span>/Get-ImageInfo          - Displays information about images in a WIM, a VHD</span></span>\n<span class=\"line\"><span>                            or a FFU file.</span></span>\n<span class=\"line\"><span>/Commit-Image           - Saves changes to a mounted WIM or VHD image.</span></span>\n<span class=\"line\"><span>/Unmount-Image          - Unmounts a mounted WIM or VHD image.</span></span>\n<span class=\"line\"><span>/Mount-Image            - Mounts an image from a WIM or VHD file.</span></span>\n<span class=\"line\"><span>/Remount-Image          - Recovers an orphaned image mount directory.</span></span>\n<span class=\"line\"><span>/Cleanup-Mountpoints    - Deletes resources associated with corrupted</span></span>\n<span class=\"line\"><span>                            mounted images.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>IMAGE SPECIFICATIONS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Online                 - Targets the running operating system.</span></span>\n<span class=\"line\"><span>/Image                  - Specifies the path to the root directory of an</span></span>\n<span class=\"line\"><span>                            offline Windows image.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DISM OPTIONS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/English                - Displays command line output in English.</span></span>\n<span class=\"line\"><span>/Format                 - Specifies the report output format.</span></span>\n<span class=\"line\"><span>/WinDir                 - Specifies the path to the Windows directory.</span></span>\n<span class=\"line\"><span>/SysDriveDir            - Specifies the path to the system-loader file named</span></span>\n<span class=\"line\"><span>                            BootMgr.</span></span>\n<span class=\"line\"><span>/LogPath                - Specifies the logfile path.</span></span>\n<span class=\"line\"><span>/LogLevel               - Specifies the output level shown in the log (1-4).</span></span>\n<span class=\"line\"><span>/NoRestart              - Suppresses automatic reboots and reboot prompts.</span></span>\n<span class=\"line\"><span>/Quiet                  - Suppresses all output except for error messages.</span></span>\n<span class=\"line\"><span>/ScratchDir             - Specifies the path to a scratch directory.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>For more information about these DISM options and their arguments, specify an</span></span>\n<span class=\"line\"><span>option immediately before /?.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Examples:     </span></span>\n<span class=\"line\"><span>    DISM.exe /Mount-Wim /?</span></span>\n<span class=\"line\"><span>    DISM.exe /ScratchDir /?</span></span>\n<span class=\"line\"><span>    DISM.exe /Image:C:\\test\\offline /?</span></span>\n<span class=\"line\"><span>    DISM.exe /Online /?</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<p>Let’s take a minute to parse this information.</p>\n<h3 id=\"dism-command-structure\">DISM Command Structure</h3>\n<blockquote>\n<p>DISM.exe [dism_options] {Imaging_command} [&#x3C;Imaging_arguments>]</p>\n</blockquote>\n<p>We can say that DISM works by taking a list of options as most programs do. It then accepts a <code>Imaging_command</code> and a list of <code>Image_arguments</code>.</p>\n<p>We know from the description above that the <code>Imaging_command</code> is sorted into three groups: <code>FFU COMMANDS</code>, <code>WIM COMMANDS</code>, and <code>GENERIC IMAGING COMMANDS</code>.</p>\n<blockquote>\n<p>DISM.exe {/Image:&#x3C;path_to_offline_image> | /Online} [dism_options] {servicing_command} [&#x3C;servicing_arguments>]</p>\n</blockquote>\n<p>In this structure we either choose an offline image or a use <code>/Online</code> to signify that we are working on the running copy of windows. <em><strong>Not all of the servicing commands work on online images, aka running machines.</strong></em></p>\n<h3 id=\"what-is-a-ffu\">What is a FFU?</h3>\n<p>A <strong>FFU</strong> is a <strong>Full Flash Update</strong> and it is a image that allows you to deploy a physical disk’s image to another drive. It includes windows, system partition information, and recovery information.</p>\n<p>We know the FFU capture commands from the above output.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>/Capture-Ffu            - Captures a physical disk image into a new FFU file.</span></span>\n<span class=\"line\"><span>/Apply-Ffu              - Applies an .ffu image.</span></span>\n<span class=\"line\"><span>/Split-Ffu              - Splits an existing .ffu file into multiple read-only</span></span>\n<span class=\"line\"><span>                            split FFU files.</span></span>\n<span class=\"line\"><span>/Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage </span></span>\n<span class=\"line\"><span>                            of a different size.</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<h3 id=\"what-is-a-wim\">What is a WIM?</h3>\n<p>A <strong>WIM</strong>, as previously stated, is a file that uses <strong>Windows Imaging Format</strong>. It is a <strong>W</strong>indows <strong>IM</strong>age, or multiple, in a single disk image.\r\nThis first came with windows in Vista and allowed for a better customization of the disk image before deployment. You can also boot and run a <strong>WIM</strong>.\r\nMost images are sector based like drives. WIM files on the other hand are file based.</p>\n<p>Many WIM files will contain multiple copies of windows. For instance, the Windows install disk actually contains all of the copies of the desktop version.\r\nWindows s, Home, Professional can all be on the same disk. That’s why you can install either version from one disk. It has been like this since at least Windows Vista.\r\nI remeber the disks that came with laptops often had each version and you would have to choose based on you key if you reinstalled. —Perhaps that’s just me showing my age.</p>\n<p>In the Vista days there was a took called ImageX. It was used to customized the OS for OEM builds. This meant that manufacturers could add\r\ndrivers, or bloatware, straight on the installer. ImageX was replaced with DISM in later versions of Windows.</p>\n<p>Windows Vista and 7 used ImageX to create <strong>WIM</strong> files.</p>\n<p>Windows 8 and later can use <strong>DISM</strong> to create and modify <strong>WIM</strong> files.</p>\n<p><em>I vaguely remember using Norton Ghost in IT to create disk images that would be deployed to the many computers over the network using GhostCast and PXE boot. The more modern approach is to use Windows server to set up a PXE server. This is done using WIM files of the windows installer.</em></p>\n<p>As with the <strong>FFU</strong> commands, we can see that our <strong>WIM</strong> commands are as follows:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>WIM COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Apply-CustomDataImage  - Dehydrates files contained in the custom data image.</span></span>\n<span class=\"line\"><span>/Capture-CustomImage    - Captures customizations into a delta WIM file on a </span></span>\n<span class=\"line\"><span>                            WIMBoot system. Captured directories include all </span></span>\n<span class=\"line\"><span>                            subfolders and data.</span></span>\n<span class=\"line\"><span>/Get-WIMBootEntry       - Displays WIMBoot configuration entries for the </span></span>\n<span class=\"line\"><span>                            specified disk volume.</span></span>\n<span class=\"line\"><span>/Update-WIMBootEntry    - Updates WIMBoot configuration entry for the </span></span>\n<span class=\"line\"><span>                            specified disk volume.</span></span>\n<span class=\"line\"><span>/List-Image             - Displays a list of the files and folders in a </span></span>\n<span class=\"line\"><span>                            specified image.</span></span>\n<span class=\"line\"><span>/Delete-Image           - Deletes the specified volume image from a WIM file</span></span>\n<span class=\"line\"><span>                            that has multiple volume images.</span></span>\n<span class=\"line\"><span>/Export-Image           - Exports a copy of the specified image to another</span></span>\n<span class=\"line\"><span>                            file.</span></span>\n<span class=\"line\"><span>/Append-Image           - Adds another image to a WIM file.</span></span>\n<span class=\"line\"><span>/Capture-Image          - Captures an image of a drive into a new WIM file.</span></span>\n<span class=\"line\"><span>                            Captured directories include all subfolders and </span></span>\n<span class=\"line\"><span>                            data.</span></span>\n<span class=\"line\"><span>/Get-MountedWimInfo     - Displays information about mounted WIM images.</span></span>\n<span class=\"line\"><span>/Get-WimInfo            - Displays information about images in a WIM file.</span></span>\n<span class=\"line\"><span>/Commit-Wim             - Saves changes to a mounted WIM image.</span></span>\n<span class=\"line\"><span>/Unmount-Wim            - Unmounts a mounted WIM image.</span></span>\n<span class=\"line\"><span>/Mount-Wim              - Mounts an image from a WIM file.</span></span>\n<span class=\"line\"><span>/Remount-Wim            - Recovers an orphaned WIM mount directory.</span></span>\n<span class=\"line\"><span>/Cleanup-Wim            - Deletes resources associated with mounted WIM </span></span>\n<span class=\"line\"><span>                            images that are corrupted.</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<h3 id=\"generic-imaging-commands\">Generic imaging commands?</h3>\n<p>They provide a set of options for working with images despite their type.</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>GENERIC IMAGING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Split-Image            - Splits an existing .wim file into multiple </span></span>\n<span class=\"line\"><span>                            read-only split WIM (SWM) files.</span></span>\n<span class=\"line\"><span>/Apply-Image            - Applies an image.</span></span>\n<span class=\"line\"><span>/Get-MountedImageInfo   - Displays information about mounted WIM and VHD</span></span>\n<span class=\"line\"><span>                            images.</span></span>\n<span class=\"line\"><span>/Get-ImageInfo          - Displays information about images in a WIM, a VHD</span></span>\n<span class=\"line\"><span>                            or a FFU file.</span></span>\n<span class=\"line\"><span>/Commit-Image           - Saves changes to a mounted WIM or VHD image.</span></span>\n<span class=\"line\"><span>/Unmount-Image          - Unmounts a mounted WIM or VHD image.</span></span>\n<span class=\"line\"><span>/Mount-Image            - Mounts an image from a WIM or VHD file.</span></span>\n<span class=\"line\"><span>/Remount-Image          - Recovers an orphaned image mount directory.</span></span>\n<span class=\"line\"><span>/Cleanup-Mountpoints    - Deletes resources associated with corrupted</span></span>\n<span class=\"line\"><span>                            mounted images.</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<h2 id=\"using-dism-online\">Using DISM “Online”</h2>\n<p>As we previously stated, using DISM online is using it on the currently running version of windows. This is an incredibly useful tool for working on the current system without having to redeploy or reimage.</p>\n<p>As with the <code>DISM /?</code> command we can also get manual pages from specific parts of the DISM command. For instance, <code>DISM /online /?</code> will produce the following:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>Deployment Image Servicing and Management tool</span></span>\n<span class=\"line\"><span>Version: 10.0.22621.1</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Image Version: 10.0.22621.963</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>The following commands may be used to service the image:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>OS UNINSTALL SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Set-OSUninstallWindow  - Sets the OS Uninstall Window.</span></span>\n<span class=\"line\"><span>/Get-OSUninstallWindow  - Gets the OS Uninstall Window.</span></span>\n<span class=\"line\"><span>/Remove-OSUninstall     - Remove the OS Uninstall.</span></span>\n<span class=\"line\"><span>/Initiate-OSUninstall   - Initiates the OS Uninstall</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>APPX SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Get-NonRemovableAppPolicy - Lists the package families configured </span></span>\n<span class=\"line\"><span>                            to be nonremovable by enterprise policy.</span></span>\n<span class=\"line\"><span>/Set-NonRemovableAppPolicy - Sets enterprise nonremovable policy for </span></span>\n<span class=\"line\"><span>                            a given package family. </span></span>\n<span class=\"line\"><span>/Optimize-ProvisionedAppxPackages - Optimizes provisioned appx footprint by </span></span>\n<span class=\"line\"><span>                            hard-linking identical files across appx packages.</span></span>\n<span class=\"line\"><span>/Set-ProvisionedAppxDataFile - Places custom data into the specified app </span></span>\n<span class=\"line\"><span>                            package (.appx or .appxbundle). The specified  </span></span>\n<span class=\"line\"><span>                            application package must already be in the image.</span></span>\n<span class=\"line\"><span>/Remove-ProvisionedAppxPackage - Removes app packages (.appx or .appxbundle)</span></span>\n<span class=\"line\"><span>                            from the image. App packages will not be installed </span></span>\n<span class=\"line\"><span>                            when new user accounts are created.</span></span>\n<span class=\"line\"><span>/Add-ProvisionedAppxPackage - Adds app packages (.appx or .appxbundle) to the</span></span>\n<span class=\"line\"><span>                            image and sets them to install for each new user.</span></span>\n<span class=\"line\"><span>/Get-ProvisionedAppxPackages - Displays information about app packages </span></span>\n<span class=\"line\"><span>                            (.appx or .appxbundle) in an image that are </span></span>\n<span class=\"line\"><span>                            set to install for each new user.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>PACKAGE SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Add-Package            - Adds packages to the image.</span></span>\n<span class=\"line\"><span>/Remove-Package         - Removes packages from the image.</span></span>\n<span class=\"line\"><span>/Enable-Feature         - Enables a specific feature in the image.</span></span>\n<span class=\"line\"><span>/Disable-Feature        - Disables a specific feature in the image.</span></span>\n<span class=\"line\"><span>/Get-Packages           - Displays information about all packages in </span></span>\n<span class=\"line\"><span>                            the image.</span></span>\n<span class=\"line\"><span>/Get-PackageInfo        - Displays information about a specific package.</span></span>\n<span class=\"line\"><span>/Get-Features           - Displays information about all features in</span></span>\n<span class=\"line\"><span>                            a package.</span></span>\n<span class=\"line\"><span>/Get-FeatureInfo        - Displays information about a specific feature.</span></span>\n<span class=\"line\"><span>/Cleanup-Image          - Performs cleanup and recovery operations on the</span></span>\n<span class=\"line\"><span>                            image.</span></span>\n<span class=\"line\"><span>/Export-Source          - Export a set of capabilities into a new repository.</span></span>\n<span class=\"line\"><span>/Add-Capability         - Add one or more capabilities to an image.</span></span>\n<span class=\"line\"><span>/Remove-Capability      - Remove a capability from one image.</span></span>\n<span class=\"line\"><span>/Get-Capabilities       - Get capabilities in the image.</span></span>\n<span class=\"line\"><span>/Get-CapabilityInfo     - Get information of a capability in the image.</span></span>\n<span class=\"line\"><span>/Get-ReservedStorageState - Gets the current state of reserved storage.</span></span>\n<span class=\"line\"><span>/Set-ReservedStorageState - Sets the state of reserved storage.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>OS GENERAL COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Optimize-Image         - Performs specified configurations to an offline </span></span>\n<span class=\"line\"><span>                            image.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DRIVER SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Remove-Driver          - Removes driver packages from an offline image.</span></span>\n<span class=\"line\"><span>/Add-Driver             - Adds driver packages to an offline image.</span></span>\n<span class=\"line\"><span>/Get-DriverInfo         - Displays information about a specific driver</span></span>\n<span class=\"line\"><span>                            in an offline image or a running operating system.</span></span>\n<span class=\"line\"><span>/Get-Drivers            - Displays information about all drivers in</span></span>\n<span class=\"line\"><span>                            an offline image or a running operating system.</span></span>\n<span class=\"line\"><span>/Export-Driver          - Export all third-party driver packages from an</span></span>\n<span class=\"line\"><span>                            offline image or a running operating system.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>APPLICATION SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Check-AppPatch         - Displays information if the MSP patches are </span></span>\n<span class=\"line\"><span>                            applicable to the mounted image.</span></span>\n<span class=\"line\"><span>/Get-AppPatchInfo       - Displays information about installed MSP patches.</span></span>\n<span class=\"line\"><span>/Get-AppPatches         - Displays information about all applied MSP patches</span></span>\n<span class=\"line\"><span>                            for all installed applications.</span></span>\n<span class=\"line\"><span>/Get-AppInfo            - Displays information about a specific installed MSI</span></span>\n<span class=\"line\"><span>                            application.</span></span>\n<span class=\"line\"><span>/Get-Apps               - Displays information about all installed MSI</span></span>\n<span class=\"line\"><span>                            applications.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>DEFAULT ASSOCIATIONS COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Remove-DefaultAppAssociations - Removes the default application associations</span></span>\n<span class=\"line\"><span>                            from a Windows image.</span></span>\n<span class=\"line\"><span>/Import-DefaultAppAssociations - Imports a set of default application </span></span>\n<span class=\"line\"><span>                            associations to a Windows image.</span></span>\n<span class=\"line\"><span>/Get-DefaultAppAssociations - Displays the list of default application </span></span>\n<span class=\"line\"><span>                            associations from a Windows image.</span></span>\n<span class=\"line\"><span>/Export-DefaultAppAssociations - Exports the default application associations</span></span>\n<span class=\"line\"><span>                            from a running operating system.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>INTERNATIONAL SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Set-SysUILang          - Sets the system UI language that is used</span></span>\n<span class=\"line\"><span>                            in the mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-LayeredDriver      - Sets keyboard layered driver.</span></span>\n<span class=\"line\"><span>/Set-UILang             - Sets the default system UI language that is used</span></span>\n<span class=\"line\"><span>                            in the mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-UILangFallback     - Sets the fallback default language for the system </span></span>\n<span class=\"line\"><span>                            UI in the mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-UserLocale         - Sets the user locale in the mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-SysLocale          - Sets the language for non-Unicode programs (also</span></span>\n<span class=\"line\"><span>                            called system locale) and font settings in the </span></span>\n<span class=\"line\"><span>                            mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-InputLocale        - Sets the input locales and keyboard layouts to </span></span>\n<span class=\"line\"><span>                            use in the mounted offline image.</span></span>\n<span class=\"line\"><span>/Set-TimeZone           - Sets the default time zone in the mounted offline</span></span>\n<span class=\"line\"><span>                            image.</span></span>\n<span class=\"line\"><span>/Set-AllIntl            - Sets all international settings in the mounted</span></span>\n<span class=\"line\"><span>                            offline image.</span></span>\n<span class=\"line\"><span>/Set-SKUIntlDefaults    - Sets all international settings to the default</span></span>\n<span class=\"line\"><span>                            values for the specified SKU language in the</span></span>\n<span class=\"line\"><span>                            mounted offline image.</span></span>\n<span class=\"line\"><span>/Gen-LangIni            - Generates a new lang.ini file.</span></span>\n<span class=\"line\"><span>/Set-SetupUILang        - Defines the default language that will be used</span></span>\n<span class=\"line\"><span>                            by setup.</span></span>\n<span class=\"line\"><span>/Get-Intl               - Displays information about the international </span></span>\n<span class=\"line\"><span>                            settings and languages.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>UNATTEND SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Apply-Unattend         - Applies an unattend file to an image.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>EDGE SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Add-Edge               - Adds Edge to image.</span></span>\n<span class=\"line\"><span>/Add-EdgeBrowser        - Adds Edge browser to image.</span></span>\n<span class=\"line\"><span>/Add-EdgeWebView        - Adds Edge WebView to image.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>PROVISIONING PACKAGE SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Get-ProvisioningPackageInfo - Gets the information of provisioning package.</span></span>\n<span class=\"line\"><span>/Add-ProvisioningPackage - Adds provisioning package.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>WINDOWS EDITION SERVICING COMMANDS:</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Set-ProductKey         - Sets the product key of the offline image.</span></span>\n<span class=\"line\"><span>/Get-TargetEditions     - Displays a list of Windows editions that an image </span></span>\n<span class=\"line\"><span>                            can be upgraded to.</span></span>\n<span class=\"line\"><span>/Get-CurrentEdition     - Displays the edition of the current image.</span></span>\n<span class=\"line\"><span>/Set-Edition            - Upgrades an image to a higher edition.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>For more information about these servicing commands and their arguments,</span></span>\n<span class=\"line\"><span>specify a command immediately before /?.</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Examples: </span></span>\n<span class=\"line\"><span>        DISM.exe /Image:C:\\test\\offline /Apply-Unattend /?</span></span>\n<span class=\"line\"><span>        DISM.exe /Image:C:\\test\\offline /Get-Features /?</span></span>\n<span class=\"line\"><span>        DISM.exe /Online /Get-Drivers /?</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<p>Thus the rabbit hole deepins.</p>\n<hr>\n<h2 id=\"why-use-dism\">Why Use DISM?</h2>\n<h3 id=\"repairing-windows\">Repairing Windows</h3>\n<p><strong>DISM</strong> is used to repair or (un)install packages or to repair, install, or backup a windows image.</p>\n<p>Lets dive into the world of <code>DISM /cleanup-image</code>.</p>\n<p>Thanks to the help info, we know the following:</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\"><code><span class=\"line\"><span>Deployment Image Servicing and Management tool</span></span>\n<span class=\"line\"><span>Version: 10.0.22621.1</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>Image Version: 10.0.22621.963</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Cleanup-Image /RevertPendingActions </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>WARNING! You should use the /RevertPendingActions option only in a </span></span>\n<span class=\"line\"><span>system-recovery scenario to perform recovery operations on a Windows image </span></span>\n<span class=\"line\"><span>that did not boot. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Example: </span></span>\n<span class=\"line\"><span>    DISM.exe /Image:C:\\test\\offline /Cleanup-Image /RevertPendingActions </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Cleanup-Image /spsuperseded [/hidesp] </span></span>\n<span class=\"line\"><span>Use /SPSuperseded to remove any backup files created during the installation </span></span>\n<span class=\"line\"><span>of a service pack. Use /HideSP to prevent the service pack from being listed </span></span>\n<span class=\"line\"><span>in the Installed Updates for the operating system. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>WARNING! The service pack cannot be uninstalled after the /SPSuperseded </span></span>\n<span class=\"line\"><span>operation is completed. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Example: </span></span>\n<span class=\"line\"><span>    DISM.exe /Image:C:\\test\\offline /Cleanup-Image /spsuperseded /hidesp </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} </span></span>\n<span class=\"line\"><span>Use /CheckHealth to check whether the image has been flagged as corrupted </span></span>\n<span class=\"line\"><span>by a failed process and whether the corruption can be repaired. </span></span>\n<span class=\"line\"><span>Use /ScanHealth to scan the image for component store corruption. </span></span>\n<span class=\"line\"><span>Use /RestoreHealth to scan the image for component store corruption, and </span></span>\n<span class=\"line\"><span>then perform repair operations automatically. </span></span>\n<span class=\"line\"><span>Use /Source with /RestoreHealth to specify the location of known good </span></span>\n<span class=\"line\"><span>versions of files that can be used for the repair. For more information on </span></span>\n<span class=\"line\"><span>specifying a source location, see </span></span>\n<span class=\"line\"><span>https://go.microsoft.com/fwlink/?LinkId=243077. </span></span>\n<span class=\"line\"><span>Use /LimitAccess to prevent DISM from contacting WU/WSUS. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Example: </span></span>\n<span class=\"line\"><span>    DISM.exe /Online /Cleanup-Image /ScanHealth</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    DISM.exe /Image:c:\\offline /Cleanup-Image /RestoreHealth </span></span>\n<span class=\"line\"><span>    /Source:c:\\test\\mount </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Cleanup-Image /StartComponentCleanup [/ResetBase [/Defer]]</span></span>\n<span class=\"line\"><span>Use /StartComponentCleanup to clean up the superseded components and reduce</span></span>\n<span class=\"line\"><span>the size of the component store. Use /ResetBase to reset the base of </span></span>\n<span class=\"line\"><span>superseded components, which can further reduce the component store size.</span></span>\n<span class=\"line\"><span>Use /Defer with /ResetBase to defer long-running cleanup operations to the </span></span>\n<span class=\"line\"><span>next automatic maintenance. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>WARNING!  The installed Windows Updates cannot be uninstalled after the </span></span>\n<span class=\"line\"><span>/StartComponentCleanup with /ResetBase operation is completed. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Example: </span></span>\n<span class=\"line\"><span>    DISM.exe /Image:C:\\test\\offline /Cleanup-Image /StartComponentCleanup</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>/Cleanup-Image /AnalyzeComponentStore </span></span>\n<span class=\"line\"><span>Use /AnalyzeComponentStore to create a report of the WinSxS component store.</span></span>\n<span class=\"line\"><span>For more information about the WinSxS report and how to use the information</span></span>\n<span class=\"line\"><span>provided in the report, see</span></span>\n<span class=\"line\"><span>https://go.microsoft.com/fwlink/?LinkId=293367. </span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>    Example: </span></span>\n<span class=\"line\"><span>    DISM.exe /Image:C:\\test\\offline /Cleanup-Image /AnalyzeComponentStore</span></span>\n<span class=\"line\"><span></span></span></code></pre>\n<p>But what does this mean?</p>\n<p>Well let’s take a look at one of the most used arguments. <code>DISM /Online /Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} </code></p>\n<p>If you have had one of the many issues that exist with windows since 7 then there is a good chance you have seen this command. This uses the DISM tool on the “Online” windows image and the <code>Cleanup-Image</code> option. We then use the <code>/CheckHealth</code>, <code>/ScanHealth</code>, or <code>/RestoreHealth</code> servicing command to attempt to aqcuire information or attempt to fix the current windows image. <em><strong>This is a powerful tool.</strong></em></p>\n<h4 id=\"checkhealth\">CheckHealth</h4>\n<blockquote>\n<p><code>DISM /Online /Cleanup-Image /CheckHealth</code></p>\n</blockquote>\n<p>This is used to check the DISM version, image version, and weather or not the component store is currupted or repairable. This is one of the quickest ways of seeing if something is wrong with your current system.</p>\n<h4 id=\"scanhealth\">ScanHealth</h4>\n<blockquote>\n<p><code>DISM /Online /Cleanup-Image /ScanHealth</code></p>\n</blockquote>\n<p>This is probably one of the most comman fix suggestions on the internet. Anything wonky with windows and people will suggest this as a quick fix. Why is this? Well, it works a small percentage of the time.</p>\n<p>What this does is scans the currently running windows image and checks for any issues that it can resolve. It can fix these issues by pulling the missing or broken dependencies from Microsoft. This option means not having to pull out installation media to attempt a fix of windows, or having to reinstall in many cases.</p>\n<h4 id=\"restorehealth\">RestoreHealth</h4>\n<blockquote>\n<p>`DISM /Online /Cleanup-Image /RestoreHealth</p>\n</blockquote>\n<p>This is the powerful tool we mentioned above. This allows us to restore the missing or currupt files from a trusted source. Using this command will pull the needed files from Microsoft to repair your running version of Windows. This isn’t a cure-all but it works for most system corruption issues.</p>";

				const frontmatter = {"title":"What is DISM","description":"Deployment Image Servicing and Management","draft":false,"category":"Windows"};
				const file = "C:/Users/meatw/source/repos/brunscii/astro-blog-site/src/content/blog/APlusTerms/Windows/dism/whatIsDISM.md";
				const url = undefined;
				function rawContent() {
					return "\r\n## What is DISM\r\n\r\n**DISM** is a an acronym for **Deployment Image Servicing and Management**. It is a command line tool for (un)installing, updating, \r\nand configuring windows features in an image. DISM can be used to capture, split, and manage .wim files, which hold windows images. What's an image?\r\nImage files are a way of representing a disk, more on that later. \r\n\r\nDISM is a powerful utility that allows you to modify your copy of windows from the command line. This allows you to customize the operating \r\nsystem in ways that aren't available in the system itself. I have used it to install packages, fix the operating system, and remove unwanted features. \r\nThis is a great tool shrouded in mystery so let's take a deeper look and unwrap this windows gem. \r\n\r\nOne thing I always like to do is try the command out first. In linux I would run `man` to get the manual pages but in windows you can often run the \r\ncommand with no options or with `/?` to get information on the command itself. This allows us (in most cases) to see a list of options for the command.\r\nIt also provides a syntax for how to use the command and any required arguments. This is what I got when I ran `DISM` in the windows terminal.\r\n\r\n\r\n    \r\n\r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n\r\n    DISM.exe [dism_options] {Imaging_command} [<Imaging_arguments>]\r\n    DISM.exe {/Image:<path_to_offline_image> | /Online} [dism_options] \r\n            {servicing_command} [<servicing_arguments>]\r\n\r\n    DESCRIPTION:\r\n\r\n    DISM enumerates, installs, uninstalls, configures, and updates features\r\n    and packages in Windows images. The commands that are available depend \r\n    on the image being serviced and whether the image is offline or running.\r\n\r\n    ****\r\n    FFU COMMANDS:\r\n\r\n    /Capture-Ffu            - Captures a physical disk image into a new FFU file.\r\n    /Apply-Ffu              - Applies an .ffu image.\r\n    /Split-Ffu              - Splits an existing .ffu file into multiple read-only\r\n                                split FFU files.\r\n    /Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage \r\n                                of a different size.\r\n\r\n    WIM COMMANDS:\r\n\r\n    /Apply-CustomDataImage  - Dehydrates files contained in the custom data image.\r\n    /Capture-CustomImage    - Captures customizations into a delta WIM file on a \r\n                                WIMBoot system. Captured directories include all \r\n                                subfolders and data.\r\n    /Get-WIMBootEntry       - Displays WIMBoot configuration entries for the \r\n                                specified disk volume.\r\n    /Update-WIMBootEntry    - Updates WIMBoot configuration entry for the \r\n                                specified disk volume.\r\n    /List-Image             - Displays a list of the files and folders in a \r\n                                specified image.\r\n    /Delete-Image           - Deletes the specified volume image from a WIM file\r\n                                that has multiple volume images.\r\n    /Export-Image           - Exports a copy of the specified image to another\r\n                                file.\r\n    /Append-Image           - Adds another image to a WIM file.\r\n    /Capture-Image          - Captures an image of a drive into a new WIM file.\r\n                                Captured directories include all subfolders and \r\n                                data.\r\n    /Get-MountedWimInfo     - Displays information about mounted WIM images.\r\n    /Get-WimInfo            - Displays information about images in a WIM file.\r\n    /Commit-Wim             - Saves changes to a mounted WIM image.\r\n    /Unmount-Wim            - Unmounts a mounted WIM image.\r\n    /Mount-Wim              - Mounts an image from a WIM file.\r\n    /Remount-Wim            - Recovers an orphaned WIM mount directory.\r\n    /Cleanup-Wim            - Deletes resources associated with mounted WIM \r\n                                images that are corrupted.\r\n\r\n    GENERIC IMAGING COMMANDS:\r\n\r\n    /Split-Image            - Splits an existing .wim file into multiple \r\n                                read-only split WIM (SWM) files.\r\n    /Apply-Image            - Applies an image.\r\n    /Get-MountedImageInfo   - Displays information about mounted WIM and VHD\r\n                                images.\r\n    /Get-ImageInfo          - Displays information about images in a WIM, a VHD\r\n                                or a FFU file.\r\n    /Commit-Image           - Saves changes to a mounted WIM or VHD image.\r\n    /Unmount-Image          - Unmounts a mounted WIM or VHD image.\r\n    /Mount-Image            - Mounts an image from a WIM or VHD file.\r\n    /Remount-Image          - Recovers an orphaned image mount directory.\r\n    /Cleanup-Mountpoints    - Deletes resources associated with corrupted\r\n                                mounted images.\r\n\r\n    IMAGE SPECIFICATIONS:\r\n\r\n    /Online                 - Targets the running operating system.\r\n    /Image                  - Specifies the path to the root directory of an\r\n                                offline Windows image.\r\n\r\n    DISM OPTIONS:\r\n\r\n    /English                - Displays command line output in English.\r\n    /Format                 - Specifies the report output format.\r\n    /WinDir                 - Specifies the path to the Windows directory.\r\n    /SysDriveDir            - Specifies the path to the system-loader file named\r\n                                BootMgr.\r\n    /LogPath                - Specifies the logfile path.\r\n    /LogLevel               - Specifies the output level shown in the log (1-4).\r\n    /NoRestart              - Suppresses automatic reboots and reboot prompts.\r\n    /Quiet                  - Suppresses all output except for error messages.\r\n    /ScratchDir             - Specifies the path to a scratch directory.\r\n\r\n    For more information about these DISM options and their arguments, specify an\r\n    option immediately before /?.\r\n\r\n    Examples:     \r\n        DISM.exe /Mount-Wim /?\r\n        DISM.exe /ScratchDir /?\r\n        DISM.exe /Image:C:\\test\\offline /?\r\n        DISM.exe /Online /?\r\n\r\n\r\nLet's take a minute to parse this information.\r\n\r\n### DISM Command Structure\r\n\r\n> DISM.exe [dism_options] {Imaging_command} [<Imaging_arguments>]\r\n\r\nWe can say that DISM works by taking a list of options as most programs do. It then accepts a `Imaging_command` and a list of `Image_arguments`. \r\n\r\nWe know from the description above that the `Imaging_command` is sorted into three groups: `FFU COMMANDS`, `WIM COMMANDS`, and `GENERIC IMAGING COMMANDS`.\r\n\r\n> DISM.exe {/Image:<path_to_offline_image> | /Online} [dism_options] {servicing_command} [<servicing_arguments>] \r\n\r\n\r\nIn this structure we either choose an offline image or a use `/Online` to signify that we are working on the running copy of windows. ***Not all of the servicing commands work on online images, aka running machines.***\r\n\r\n\r\n\r\n### What is a FFU?\r\nA **FFU** is a **Full Flash Update** and it is a image that allows you to deploy a physical disk's image to another drive. It includes windows, system partition information, and recovery information.\r\n\r\nWe know the FFU capture commands from the above output.\r\n\r\n    /Capture-Ffu            - Captures a physical disk image into a new FFU file.\r\n    /Apply-Ffu              - Applies an .ffu image.\r\n    /Split-Ffu              - Splits an existing .ffu file into multiple read-only\r\n                                split FFU files.\r\n    /Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage \r\n                                of a different size.\r\n\r\n### What is a WIM?\r\n\r\nA **WIM**, as previously stated, is a file that uses **Windows Imaging Format**. It is a **W**indows **IM**age, or multiple, in a single disk image. \r\nThis first came with windows in Vista and allowed for a better customization of the disk image before deployment. You can also boot and run a **WIM**. \r\nMost images are sector based like drives. WIM files on the other hand are file based. \r\n\r\nMany WIM files will contain multiple copies of windows. For instance, the Windows install disk actually contains all of the copies of the desktop version.\r\nWindows s, Home, Professional can all be on the same disk. That's why you can install either version from one disk. It has been like this since at least Windows Vista. \r\nI remeber the disks that came with laptops often had each version and you would have to choose based on you key if you reinstalled. --Perhaps that's just me showing my age.\r\n\r\nIn the Vista days there was a took called ImageX. It was used to customized the OS for OEM builds. This meant that manufacturers could add\r\ndrivers, or bloatware, straight on the installer. ImageX was replaced with DISM in later versions of Windows. \r\n\r\nWindows Vista and 7 used ImageX to create **WIM** files.\r\n\r\nWindows 8 and later can use **DISM** to create and modify **WIM** files.\r\n\r\n*I vaguely remember using Norton Ghost in IT to create disk images that would be deployed to the many computers over the network using GhostCast and PXE boot. The more modern approach is to use Windows server to set up a PXE server. This is done using WIM files of the windows installer.*\r\n\r\nAs with the **FFU** commands, we can see that our **WIM** commands are as follows:\r\n\r\n    WIM COMMANDS:\r\n\r\n    /Apply-CustomDataImage  - Dehydrates files contained in the custom data image.\r\n    /Capture-CustomImage    - Captures customizations into a delta WIM file on a \r\n                                WIMBoot system. Captured directories include all \r\n                                subfolders and data.\r\n    /Get-WIMBootEntry       - Displays WIMBoot configuration entries for the \r\n                                specified disk volume.\r\n    /Update-WIMBootEntry    - Updates WIMBoot configuration entry for the \r\n                                specified disk volume.\r\n    /List-Image             - Displays a list of the files and folders in a \r\n                                specified image.\r\n    /Delete-Image           - Deletes the specified volume image from a WIM file\r\n                                that has multiple volume images.\r\n    /Export-Image           - Exports a copy of the specified image to another\r\n                                file.\r\n    /Append-Image           - Adds another image to a WIM file.\r\n    /Capture-Image          - Captures an image of a drive into a new WIM file.\r\n                                Captured directories include all subfolders and \r\n                                data.\r\n    /Get-MountedWimInfo     - Displays information about mounted WIM images.\r\n    /Get-WimInfo            - Displays information about images in a WIM file.\r\n    /Commit-Wim             - Saves changes to a mounted WIM image.\r\n    /Unmount-Wim            - Unmounts a mounted WIM image.\r\n    /Mount-Wim              - Mounts an image from a WIM file.\r\n    /Remount-Wim            - Recovers an orphaned WIM mount directory.\r\n    /Cleanup-Wim            - Deletes resources associated with mounted WIM \r\n                                images that are corrupted.\r\n\r\n### Generic imaging commands?\r\n\r\nThey provide a set of options for working with images despite their type.\r\n\r\n    GENERIC IMAGING COMMANDS:\r\n\r\n    /Split-Image            - Splits an existing .wim file into multiple \r\n                                read-only split WIM (SWM) files.\r\n    /Apply-Image            - Applies an image.\r\n    /Get-MountedImageInfo   - Displays information about mounted WIM and VHD\r\n                                images.\r\n    /Get-ImageInfo          - Displays information about images in a WIM, a VHD\r\n                                or a FFU file.\r\n    /Commit-Image           - Saves changes to a mounted WIM or VHD image.\r\n    /Unmount-Image          - Unmounts a mounted WIM or VHD image.\r\n    /Mount-Image            - Mounts an image from a WIM or VHD file.\r\n    /Remount-Image          - Recovers an orphaned image mount directory.\r\n    /Cleanup-Mountpoints    - Deletes resources associated with corrupted\r\n                                mounted images.\r\n\r\n## Using DISM \"Online\"\r\n\r\nAs we previously stated, using DISM online is using it on the currently running version of windows. This is an incredibly useful tool for working on the current system without having to redeploy or reimage. \r\n\r\nAs with the `DISM /?` command we can also get manual pages from specific parts of the DISM command. For instance, `DISM /online /?` will produce the following:\r\n\r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n    Image Version: 10.0.22621.963\r\n\r\n\r\n    The following commands may be used to service the image:\r\n\r\n    OS UNINSTALL SERVICING COMMANDS:\r\n\r\n    /Set-OSUninstallWindow  - Sets the OS Uninstall Window.\r\n    /Get-OSUninstallWindow  - Gets the OS Uninstall Window.\r\n    /Remove-OSUninstall     - Remove the OS Uninstall.\r\n    /Initiate-OSUninstall   - Initiates the OS Uninstall\r\n\r\n    APPX SERVICING COMMANDS:\r\n\r\n    /Get-NonRemovableAppPolicy - Lists the package families configured \r\n                                to be nonremovable by enterprise policy.\r\n    /Set-NonRemovableAppPolicy - Sets enterprise nonremovable policy for \r\n                                a given package family. \r\n    /Optimize-ProvisionedAppxPackages - Optimizes provisioned appx footprint by \r\n                                hard-linking identical files across appx packages.\r\n    /Set-ProvisionedAppxDataFile - Places custom data into the specified app \r\n                                package (.appx or .appxbundle). The specified  \r\n                                application package must already be in the image.\r\n    /Remove-ProvisionedAppxPackage - Removes app packages (.appx or .appxbundle)\r\n                                from the image. App packages will not be installed \r\n                                when new user accounts are created.\r\n    /Add-ProvisionedAppxPackage - Adds app packages (.appx or .appxbundle) to the\r\n                                image and sets them to install for each new user.\r\n    /Get-ProvisionedAppxPackages - Displays information about app packages \r\n                                (.appx or .appxbundle) in an image that are \r\n                                set to install for each new user.\r\n\r\n    PACKAGE SERVICING COMMANDS:\r\n\r\n    /Add-Package            - Adds packages to the image.\r\n    /Remove-Package         - Removes packages from the image.\r\n    /Enable-Feature         - Enables a specific feature in the image.\r\n    /Disable-Feature        - Disables a specific feature in the image.\r\n    /Get-Packages           - Displays information about all packages in \r\n                                the image.\r\n    /Get-PackageInfo        - Displays information about a specific package.\r\n    /Get-Features           - Displays information about all features in\r\n                                a package.\r\n    /Get-FeatureInfo        - Displays information about a specific feature.\r\n    /Cleanup-Image          - Performs cleanup and recovery operations on the\r\n                                image.\r\n    /Export-Source          - Export a set of capabilities into a new repository.\r\n    /Add-Capability         - Add one or more capabilities to an image.\r\n    /Remove-Capability      - Remove a capability from one image.\r\n    /Get-Capabilities       - Get capabilities in the image.\r\n    /Get-CapabilityInfo     - Get information of a capability in the image.\r\n    /Get-ReservedStorageState - Gets the current state of reserved storage.\r\n    /Set-ReservedStorageState - Sets the state of reserved storage.\r\n\r\n    OS GENERAL COMMANDS:\r\n\r\n    /Optimize-Image         - Performs specified configurations to an offline \r\n                                image.\r\n\r\n    DRIVER SERVICING COMMANDS:\r\n\r\n    /Remove-Driver          - Removes driver packages from an offline image.\r\n    /Add-Driver             - Adds driver packages to an offline image.\r\n    /Get-DriverInfo         - Displays information about a specific driver\r\n                                in an offline image or a running operating system.\r\n    /Get-Drivers            - Displays information about all drivers in\r\n                                an offline image or a running operating system.\r\n    /Export-Driver          - Export all third-party driver packages from an\r\n                                offline image or a running operating system.\r\n\r\n    APPLICATION SERVICING COMMANDS:\r\n\r\n    /Check-AppPatch         - Displays information if the MSP patches are \r\n                                applicable to the mounted image.\r\n    /Get-AppPatchInfo       - Displays information about installed MSP patches.\r\n    /Get-AppPatches         - Displays information about all applied MSP patches\r\n                                for all installed applications.\r\n    /Get-AppInfo            - Displays information about a specific installed MSI\r\n                                application.\r\n    /Get-Apps               - Displays information about all installed MSI\r\n                                applications.\r\n\r\n    DEFAULT ASSOCIATIONS COMMANDS:\r\n\r\n    /Remove-DefaultAppAssociations - Removes the default application associations\r\n                                from a Windows image.\r\n    /Import-DefaultAppAssociations - Imports a set of default application \r\n                                associations to a Windows image.\r\n    /Get-DefaultAppAssociations - Displays the list of default application \r\n                                associations from a Windows image.\r\n    /Export-DefaultAppAssociations - Exports the default application associations\r\n                                from a running operating system.\r\n\r\n    INTERNATIONAL SERVICING COMMANDS:\r\n\r\n    /Set-SysUILang          - Sets the system UI language that is used\r\n                                in the mounted offline image.\r\n    /Set-LayeredDriver      - Sets keyboard layered driver.\r\n    /Set-UILang             - Sets the default system UI language that is used\r\n                                in the mounted offline image.\r\n    /Set-UILangFallback     - Sets the fallback default language for the system \r\n                                UI in the mounted offline image.\r\n    /Set-UserLocale         - Sets the user locale in the mounted offline image.\r\n    /Set-SysLocale          - Sets the language for non-Unicode programs (also\r\n                                called system locale) and font settings in the \r\n                                mounted offline image.\r\n    /Set-InputLocale        - Sets the input locales and keyboard layouts to \r\n                                use in the mounted offline image.\r\n    /Set-TimeZone           - Sets the default time zone in the mounted offline\r\n                                image.\r\n    /Set-AllIntl            - Sets all international settings in the mounted\r\n                                offline image.\r\n    /Set-SKUIntlDefaults    - Sets all international settings to the default\r\n                                values for the specified SKU language in the\r\n                                mounted offline image.\r\n    /Gen-LangIni            - Generates a new lang.ini file.\r\n    /Set-SetupUILang        - Defines the default language that will be used\r\n                                by setup.\r\n    /Get-Intl               - Displays information about the international \r\n                                settings and languages.\r\n\r\n    UNATTEND SERVICING COMMANDS:\r\n\r\n    /Apply-Unattend         - Applies an unattend file to an image.\r\n\r\n    EDGE SERVICING COMMANDS:\r\n\r\n    /Add-Edge               - Adds Edge to image.\r\n    /Add-EdgeBrowser        - Adds Edge browser to image.\r\n    /Add-EdgeWebView        - Adds Edge WebView to image.\r\n\r\n    PROVISIONING PACKAGE SERVICING COMMANDS:\r\n\r\n    /Get-ProvisioningPackageInfo - Gets the information of provisioning package.\r\n    /Add-ProvisioningPackage - Adds provisioning package.\r\n\r\n    WINDOWS EDITION SERVICING COMMANDS:\r\n\r\n    /Set-ProductKey         - Sets the product key of the offline image.\r\n    /Get-TargetEditions     - Displays a list of Windows editions that an image \r\n                                can be upgraded to.\r\n    /Get-CurrentEdition     - Displays the edition of the current image.\r\n    /Set-Edition            - Upgrades an image to a higher edition.\r\n\r\n    For more information about these servicing commands and their arguments,\r\n    specify a command immediately before /?.\r\n\r\n        Examples: \r\n            DISM.exe /Image:C:\\test\\offline /Apply-Unattend /?\r\n            DISM.exe /Image:C:\\test\\offline /Get-Features /?\r\n            DISM.exe /Online /Get-Drivers /?\r\n\r\nThus the rabbit hole deepins. \r\n\r\n\r\n---\r\n## Why Use DISM?\r\n\r\n### Repairing Windows\r\n\r\n**DISM** is used to repair or (un)install packages or to repair, install, or backup a windows image.\r\n\r\nLets dive into the world of `DISM /cleanup-image`.\r\n\r\nThanks to the help info, we know the following: \r\n\r\n    \r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n    Image Version: 10.0.22621.963\r\n\r\n\r\n    /Cleanup-Image /RevertPendingActions \r\n\r\n    WARNING! You should use the /RevertPendingActions option only in a \r\n    system-recovery scenario to perform recovery operations on a Windows image \r\n    that did not boot. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /RevertPendingActions \r\n\r\n    /Cleanup-Image /spsuperseded [/hidesp] \r\n    Use /SPSuperseded to remove any backup files created during the installation \r\n    of a service pack. Use /HideSP to prevent the service pack from being listed \r\n    in the Installed Updates for the operating system. \r\n\r\n    WARNING! The service pack cannot be uninstalled after the /SPSuperseded \r\n    operation is completed. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /spsuperseded /hidesp \r\n\r\n    /Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} \r\n    Use /CheckHealth to check whether the image has been flagged as corrupted \r\n    by a failed process and whether the corruption can be repaired. \r\n    Use /ScanHealth to scan the image for component store corruption. \r\n    Use /RestoreHealth to scan the image for component store corruption, and \r\n    then perform repair operations automatically. \r\n    Use /Source with /RestoreHealth to specify the location of known good \r\n    versions of files that can be used for the repair. For more information on \r\n    specifying a source location, see \r\n    https://go.microsoft.com/fwlink/?LinkId=243077. \r\n    Use /LimitAccess to prevent DISM from contacting WU/WSUS. \r\n\r\n        Example: \r\n        DISM.exe /Online /Cleanup-Image /ScanHealth\r\n\r\n        DISM.exe /Image:c:\\offline /Cleanup-Image /RestoreHealth \r\n        /Source:c:\\test\\mount \r\n\r\n    /Cleanup-Image /StartComponentCleanup [/ResetBase [/Defer]]\r\n    Use /StartComponentCleanup to clean up the superseded components and reduce\r\n    the size of the component store. Use /ResetBase to reset the base of \r\n    superseded components, which can further reduce the component store size.\r\n    Use /Defer with /ResetBase to defer long-running cleanup operations to the \r\n    next automatic maintenance. \r\n\r\n    WARNING!  The installed Windows Updates cannot be uninstalled after the \r\n    /StartComponentCleanup with /ResetBase operation is completed. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /StartComponentCleanup\r\n\r\n    /Cleanup-Image /AnalyzeComponentStore \r\n    Use /AnalyzeComponentStore to create a report of the WinSxS component store.\r\n    For more information about the WinSxS report and how to use the information\r\n    provided in the report, see\r\n    https://go.microsoft.com/fwlink/?LinkId=293367. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /AnalyzeComponentStore\r\n\r\n\r\nBut what does this mean? \r\n\r\nWell let's take a look at one of the most used arguments. `DISM /Online /Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} `\r\n\r\nIf you have had one of the many issues that exist with windows since 7 then there is a good chance you have seen this command. This uses the DISM tool on the \"Online\" windows image and the `Cleanup-Image` option. We then use the `/CheckHealth`, `/ScanHealth`, or `/RestoreHealth` servicing command to attempt to aqcuire information or attempt to fix the current windows image. ***This is a powerful tool.***\r\n\r\n\r\n #### CheckHealth\r\n \r\n > `DISM /Online /Cleanup-Image /CheckHealth`\r\n \r\n This is used to check the DISM version, image version, and weather or not the component store is currupted or repairable. This is one of the quickest ways of seeing if something is wrong with your current system. \r\n \r\n#### ScanHealth\r\n\r\n> `DISM /Online /Cleanup-Image /ScanHealth`\r\n\r\nThis is probably one of the most comman fix suggestions on the internet. Anything wonky with windows and people will suggest this as a quick fix. Why is this? Well, it works a small percentage of the time. \r\n\r\nWhat this does is scans the currently running windows image and checks for any issues that it can resolve. It can fix these issues by pulling the missing or broken dependencies from Microsoft. This option means not having to pull out installation media to attempt a fix of windows, or having to reinstall in many cases.\r\n\r\n#### RestoreHealth\r\n\r\n> `DISM /Online /Cleanup-Image /RestoreHealth\r\n\r\nThis is the powerful tool we mentioned above. This allows us to restore the missing or currupt files from a trusted source. Using this command will pull the needed files from Microsoft to repair your running version of Windows. This isn't a cure-all but it works for most system corruption issues.\r\n ";
				}
				function compiledContent() {
					return html;
				}
				function getHeadings() {
					return [{"depth":2,"slug":"what-is-dism","text":"What is DISM"},{"depth":3,"slug":"dism-command-structure","text":"DISM Command Structure"},{"depth":3,"slug":"what-is-a-ffu","text":"What is a FFU?"},{"depth":3,"slug":"what-is-a-wim","text":"What is a WIM?"},{"depth":3,"slug":"generic-imaging-commands","text":"Generic imaging commands?"},{"depth":2,"slug":"using-dism-online","text":"Using DISM “Online”"},{"depth":2,"slug":"why-use-dism","text":"Why Use DISM?"},{"depth":3,"slug":"repairing-windows","text":"Repairing Windows"},{"depth":4,"slug":"checkhealth","text":"CheckHealth"},{"depth":4,"slug":"scanhealth","text":"ScanHealth"},{"depth":4,"slug":"restorehealth","text":"RestoreHealth"}];
				}

				const Content = createComponent((result, _props, slots) => {
					const { layout, ...content } = frontmatter;
					content.file = file;
					content.url = url;

					return renderTemplate`${maybeRenderHead()}${unescapeHTML(html)}`;
				});

export { Content, compiledContent, Content as default, file, frontmatter, getHeadings, rawContent, url };
