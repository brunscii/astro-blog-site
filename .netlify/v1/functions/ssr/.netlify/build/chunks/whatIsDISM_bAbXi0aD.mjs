const id = "APlusTerms/Windows/dism/whatIsDISM.md";
						const collection = "blog";
						const slug = "aplusterms/windows/dism/whatisdism";
						const body = "\r\n## What is DISM\r\n\r\n**DISM** is a an acronym for **Deployment Image Servicing and Management**. It is a command line tool for (un)installing, updating, \r\nand configuring windows features in an image. DISM can be used to capture, split, and manage .wim files, which hold windows images. What's an image?\r\nImage files are a way of representing a disk, more on that later. \r\n\r\nDISM is a powerful utility that allows you to modify your copy of windows from the command line. This allows you to customize the operating \r\nsystem in ways that aren't available in the system itself. I have used it to install packages, fix the operating system, and remove unwanted features. \r\nThis is a great tool shrouded in mystery so let's take a deeper look and unwrap this windows gem. \r\n\r\nOne thing I always like to do is try the command out first. In linux I would run `man` to get the manual pages but in windows you can often run the \r\ncommand with no options or with `/?` to get information on the command itself. This allows us (in most cases) to see a list of options for the command.\r\nIt also provides a syntax for how to use the command and any required arguments. This is what I got when I ran `DISM` in the windows terminal.\r\n\r\n\r\n    \r\n\r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n\r\n    DISM.exe [dism_options] {Imaging_command} [<Imaging_arguments>]\r\n    DISM.exe {/Image:<path_to_offline_image> | /Online} [dism_options] \r\n            {servicing_command} [<servicing_arguments>]\r\n\r\n    DESCRIPTION:\r\n\r\n    DISM enumerates, installs, uninstalls, configures, and updates features\r\n    and packages in Windows images. The commands that are available depend \r\n    on the image being serviced and whether the image is offline or running.\r\n\r\n    ****\r\n    FFU COMMANDS:\r\n\r\n    /Capture-Ffu            - Captures a physical disk image into a new FFU file.\r\n    /Apply-Ffu              - Applies an .ffu image.\r\n    /Split-Ffu              - Splits an existing .ffu file into multiple read-only\r\n                                split FFU files.\r\n    /Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage \r\n                                of a different size.\r\n\r\n    WIM COMMANDS:\r\n\r\n    /Apply-CustomDataImage  - Dehydrates files contained in the custom data image.\r\n    /Capture-CustomImage    - Captures customizations into a delta WIM file on a \r\n                                WIMBoot system. Captured directories include all \r\n                                subfolders and data.\r\n    /Get-WIMBootEntry       - Displays WIMBoot configuration entries for the \r\n                                specified disk volume.\r\n    /Update-WIMBootEntry    - Updates WIMBoot configuration entry for the \r\n                                specified disk volume.\r\n    /List-Image             - Displays a list of the files and folders in a \r\n                                specified image.\r\n    /Delete-Image           - Deletes the specified volume image from a WIM file\r\n                                that has multiple volume images.\r\n    /Export-Image           - Exports a copy of the specified image to another\r\n                                file.\r\n    /Append-Image           - Adds another image to a WIM file.\r\n    /Capture-Image          - Captures an image of a drive into a new WIM file.\r\n                                Captured directories include all subfolders and \r\n                                data.\r\n    /Get-MountedWimInfo     - Displays information about mounted WIM images.\r\n    /Get-WimInfo            - Displays information about images in a WIM file.\r\n    /Commit-Wim             - Saves changes to a mounted WIM image.\r\n    /Unmount-Wim            - Unmounts a mounted WIM image.\r\n    /Mount-Wim              - Mounts an image from a WIM file.\r\n    /Remount-Wim            - Recovers an orphaned WIM mount directory.\r\n    /Cleanup-Wim            - Deletes resources associated with mounted WIM \r\n                                images that are corrupted.\r\n\r\n    GENERIC IMAGING COMMANDS:\r\n\r\n    /Split-Image            - Splits an existing .wim file into multiple \r\n                                read-only split WIM (SWM) files.\r\n    /Apply-Image            - Applies an image.\r\n    /Get-MountedImageInfo   - Displays information about mounted WIM and VHD\r\n                                images.\r\n    /Get-ImageInfo          - Displays information about images in a WIM, a VHD\r\n                                or a FFU file.\r\n    /Commit-Image           - Saves changes to a mounted WIM or VHD image.\r\n    /Unmount-Image          - Unmounts a mounted WIM or VHD image.\r\n    /Mount-Image            - Mounts an image from a WIM or VHD file.\r\n    /Remount-Image          - Recovers an orphaned image mount directory.\r\n    /Cleanup-Mountpoints    - Deletes resources associated with corrupted\r\n                                mounted images.\r\n\r\n    IMAGE SPECIFICATIONS:\r\n\r\n    /Online                 - Targets the running operating system.\r\n    /Image                  - Specifies the path to the root directory of an\r\n                                offline Windows image.\r\n\r\n    DISM OPTIONS:\r\n\r\n    /English                - Displays command line output in English.\r\n    /Format                 - Specifies the report output format.\r\n    /WinDir                 - Specifies the path to the Windows directory.\r\n    /SysDriveDir            - Specifies the path to the system-loader file named\r\n                                BootMgr.\r\n    /LogPath                - Specifies the logfile path.\r\n    /LogLevel               - Specifies the output level shown in the log (1-4).\r\n    /NoRestart              - Suppresses automatic reboots and reboot prompts.\r\n    /Quiet                  - Suppresses all output except for error messages.\r\n    /ScratchDir             - Specifies the path to a scratch directory.\r\n\r\n    For more information about these DISM options and their arguments, specify an\r\n    option immediately before /?.\r\n\r\n    Examples:     \r\n        DISM.exe /Mount-Wim /?\r\n        DISM.exe /ScratchDir /?\r\n        DISM.exe /Image:C:\\test\\offline /?\r\n        DISM.exe /Online /?\r\n\r\n\r\nLet's take a minute to parse this information.\r\n\r\n### DISM Command Structure\r\n\r\n> DISM.exe [dism_options] {Imaging_command} [<Imaging_arguments>]\r\n\r\nWe can say that DISM works by taking a list of options as most programs do. It then accepts a `Imaging_command` and a list of `Image_arguments`. \r\n\r\nWe know from the description above that the `Imaging_command` is sorted into three groups: `FFU COMMANDS`, `WIM COMMANDS`, and `GENERIC IMAGING COMMANDS`.\r\n\r\n> DISM.exe {/Image:<path_to_offline_image> | /Online} [dism_options] {servicing_command} [<servicing_arguments>] \r\n\r\n\r\nIn this structure we either choose an offline image or a use `/Online` to signify that we are working on the running copy of windows. ***Not all of the servicing commands work on online images, aka running machines.***\r\n\r\n\r\n\r\n### What is a FFU?\r\nA **FFU** is a **Full Flash Update** and it is a image that allows you to deploy a physical disk's image to another drive. It includes windows, system partition information, and recovery information.\r\n\r\nWe know the FFU capture commands from the above output.\r\n\r\n    /Capture-Ffu            - Captures a physical disk image into a new FFU file.\r\n    /Apply-Ffu              - Applies an .ffu image.\r\n    /Split-Ffu              - Splits an existing .ffu file into multiple read-only\r\n                                split FFU files.\r\n    /Optimize-Ffu           - Optimizes a FFU file so that it can be applied to storage \r\n                                of a different size.\r\n\r\n### What is a WIM?\r\n\r\nA **WIM**, as previously stated, is a file that uses **Windows Imaging Format**. It is a **W**indows **IM**age, or multiple, in a single disk image. \r\nThis first came with windows in Vista and allowed for a better customization of the disk image before deployment. You can also boot and run a **WIM**. \r\nMost images are sector based like drives. WIM files on the other hand are file based. \r\n\r\nMany WIM files will contain multiple copies of windows. For instance, the Windows install disk actually contains all of the copies of the desktop version.\r\nWindows s, Home, Professional can all be on the same disk. That's why you can install either version from one disk. It has been like this since at least Windows Vista. \r\nI remeber the disks that came with laptops often had each version and you would have to choose based on you key if you reinstalled. --Perhaps that's just me showing my age.\r\n\r\nIn the Vista days there was a took called ImageX. It was used to customized the OS for OEM builds. This meant that manufacturers could add\r\ndrivers, or bloatware, straight on the installer. ImageX was replaced with DISM in later versions of Windows. \r\n\r\nWindows Vista and 7 used ImageX to create **WIM** files.\r\n\r\nWindows 8 and later can use **DISM** to create and modify **WIM** files.\r\n\r\n*I vaguely remember using Norton Ghost in IT to create disk images that would be deployed to the many computers over the network using GhostCast and PXE boot. The more modern approach is to use Windows server to set up a PXE server. This is done using WIM files of the windows installer.*\r\n\r\nAs with the **FFU** commands, we can see that our **WIM** commands are as follows:\r\n\r\n    WIM COMMANDS:\r\n\r\n    /Apply-CustomDataImage  - Dehydrates files contained in the custom data image.\r\n    /Capture-CustomImage    - Captures customizations into a delta WIM file on a \r\n                                WIMBoot system. Captured directories include all \r\n                                subfolders and data.\r\n    /Get-WIMBootEntry       - Displays WIMBoot configuration entries for the \r\n                                specified disk volume.\r\n    /Update-WIMBootEntry    - Updates WIMBoot configuration entry for the \r\n                                specified disk volume.\r\n    /List-Image             - Displays a list of the files and folders in a \r\n                                specified image.\r\n    /Delete-Image           - Deletes the specified volume image from a WIM file\r\n                                that has multiple volume images.\r\n    /Export-Image           - Exports a copy of the specified image to another\r\n                                file.\r\n    /Append-Image           - Adds another image to a WIM file.\r\n    /Capture-Image          - Captures an image of a drive into a new WIM file.\r\n                                Captured directories include all subfolders and \r\n                                data.\r\n    /Get-MountedWimInfo     - Displays information about mounted WIM images.\r\n    /Get-WimInfo            - Displays information about images in a WIM file.\r\n    /Commit-Wim             - Saves changes to a mounted WIM image.\r\n    /Unmount-Wim            - Unmounts a mounted WIM image.\r\n    /Mount-Wim              - Mounts an image from a WIM file.\r\n    /Remount-Wim            - Recovers an orphaned WIM mount directory.\r\n    /Cleanup-Wim            - Deletes resources associated with mounted WIM \r\n                                images that are corrupted.\r\n\r\n### Generic imaging commands?\r\n\r\nThey provide a set of options for working with images despite their type.\r\n\r\n    GENERIC IMAGING COMMANDS:\r\n\r\n    /Split-Image            - Splits an existing .wim file into multiple \r\n                                read-only split WIM (SWM) files.\r\n    /Apply-Image            - Applies an image.\r\n    /Get-MountedImageInfo   - Displays information about mounted WIM and VHD\r\n                                images.\r\n    /Get-ImageInfo          - Displays information about images in a WIM, a VHD\r\n                                or a FFU file.\r\n    /Commit-Image           - Saves changes to a mounted WIM or VHD image.\r\n    /Unmount-Image          - Unmounts a mounted WIM or VHD image.\r\n    /Mount-Image            - Mounts an image from a WIM or VHD file.\r\n    /Remount-Image          - Recovers an orphaned image mount directory.\r\n    /Cleanup-Mountpoints    - Deletes resources associated with corrupted\r\n                                mounted images.\r\n\r\n## Using DISM \"Online\"\r\n\r\nAs we previously stated, using DISM online is using it on the currently running version of windows. This is an incredibly useful tool for working on the current system without having to redeploy or reimage. \r\n\r\nAs with the `DISM /?` command we can also get manual pages from specific parts of the DISM command. For instance, `DISM /online /?` will produce the following:\r\n\r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n    Image Version: 10.0.22621.963\r\n\r\n\r\n    The following commands may be used to service the image:\r\n\r\n    OS UNINSTALL SERVICING COMMANDS:\r\n\r\n    /Set-OSUninstallWindow  - Sets the OS Uninstall Window.\r\n    /Get-OSUninstallWindow  - Gets the OS Uninstall Window.\r\n    /Remove-OSUninstall     - Remove the OS Uninstall.\r\n    /Initiate-OSUninstall   - Initiates the OS Uninstall\r\n\r\n    APPX SERVICING COMMANDS:\r\n\r\n    /Get-NonRemovableAppPolicy - Lists the package families configured \r\n                                to be nonremovable by enterprise policy.\r\n    /Set-NonRemovableAppPolicy - Sets enterprise nonremovable policy for \r\n                                a given package family. \r\n    /Optimize-ProvisionedAppxPackages - Optimizes provisioned appx footprint by \r\n                                hard-linking identical files across appx packages.\r\n    /Set-ProvisionedAppxDataFile - Places custom data into the specified app \r\n                                package (.appx or .appxbundle). The specified  \r\n                                application package must already be in the image.\r\n    /Remove-ProvisionedAppxPackage - Removes app packages (.appx or .appxbundle)\r\n                                from the image. App packages will not be installed \r\n                                when new user accounts are created.\r\n    /Add-ProvisionedAppxPackage - Adds app packages (.appx or .appxbundle) to the\r\n                                image and sets them to install for each new user.\r\n    /Get-ProvisionedAppxPackages - Displays information about app packages \r\n                                (.appx or .appxbundle) in an image that are \r\n                                set to install for each new user.\r\n\r\n    PACKAGE SERVICING COMMANDS:\r\n\r\n    /Add-Package            - Adds packages to the image.\r\n    /Remove-Package         - Removes packages from the image.\r\n    /Enable-Feature         - Enables a specific feature in the image.\r\n    /Disable-Feature        - Disables a specific feature in the image.\r\n    /Get-Packages           - Displays information about all packages in \r\n                                the image.\r\n    /Get-PackageInfo        - Displays information about a specific package.\r\n    /Get-Features           - Displays information about all features in\r\n                                a package.\r\n    /Get-FeatureInfo        - Displays information about a specific feature.\r\n    /Cleanup-Image          - Performs cleanup and recovery operations on the\r\n                                image.\r\n    /Export-Source          - Export a set of capabilities into a new repository.\r\n    /Add-Capability         - Add one or more capabilities to an image.\r\n    /Remove-Capability      - Remove a capability from one image.\r\n    /Get-Capabilities       - Get capabilities in the image.\r\n    /Get-CapabilityInfo     - Get information of a capability in the image.\r\n    /Get-ReservedStorageState - Gets the current state of reserved storage.\r\n    /Set-ReservedStorageState - Sets the state of reserved storage.\r\n\r\n    OS GENERAL COMMANDS:\r\n\r\n    /Optimize-Image         - Performs specified configurations to an offline \r\n                                image.\r\n\r\n    DRIVER SERVICING COMMANDS:\r\n\r\n    /Remove-Driver          - Removes driver packages from an offline image.\r\n    /Add-Driver             - Adds driver packages to an offline image.\r\n    /Get-DriverInfo         - Displays information about a specific driver\r\n                                in an offline image or a running operating system.\r\n    /Get-Drivers            - Displays information about all drivers in\r\n                                an offline image or a running operating system.\r\n    /Export-Driver          - Export all third-party driver packages from an\r\n                                offline image or a running operating system.\r\n\r\n    APPLICATION SERVICING COMMANDS:\r\n\r\n    /Check-AppPatch         - Displays information if the MSP patches are \r\n                                applicable to the mounted image.\r\n    /Get-AppPatchInfo       - Displays information about installed MSP patches.\r\n    /Get-AppPatches         - Displays information about all applied MSP patches\r\n                                for all installed applications.\r\n    /Get-AppInfo            - Displays information about a specific installed MSI\r\n                                application.\r\n    /Get-Apps               - Displays information about all installed MSI\r\n                                applications.\r\n\r\n    DEFAULT ASSOCIATIONS COMMANDS:\r\n\r\n    /Remove-DefaultAppAssociations - Removes the default application associations\r\n                                from a Windows image.\r\n    /Import-DefaultAppAssociations - Imports a set of default application \r\n                                associations to a Windows image.\r\n    /Get-DefaultAppAssociations - Displays the list of default application \r\n                                associations from a Windows image.\r\n    /Export-DefaultAppAssociations - Exports the default application associations\r\n                                from a running operating system.\r\n\r\n    INTERNATIONAL SERVICING COMMANDS:\r\n\r\n    /Set-SysUILang          - Sets the system UI language that is used\r\n                                in the mounted offline image.\r\n    /Set-LayeredDriver      - Sets keyboard layered driver.\r\n    /Set-UILang             - Sets the default system UI language that is used\r\n                                in the mounted offline image.\r\n    /Set-UILangFallback     - Sets the fallback default language for the system \r\n                                UI in the mounted offline image.\r\n    /Set-UserLocale         - Sets the user locale in the mounted offline image.\r\n    /Set-SysLocale          - Sets the language for non-Unicode programs (also\r\n                                called system locale) and font settings in the \r\n                                mounted offline image.\r\n    /Set-InputLocale        - Sets the input locales and keyboard layouts to \r\n                                use in the mounted offline image.\r\n    /Set-TimeZone           - Sets the default time zone in the mounted offline\r\n                                image.\r\n    /Set-AllIntl            - Sets all international settings in the mounted\r\n                                offline image.\r\n    /Set-SKUIntlDefaults    - Sets all international settings to the default\r\n                                values for the specified SKU language in the\r\n                                mounted offline image.\r\n    /Gen-LangIni            - Generates a new lang.ini file.\r\n    /Set-SetupUILang        - Defines the default language that will be used\r\n                                by setup.\r\n    /Get-Intl               - Displays information about the international \r\n                                settings and languages.\r\n\r\n    UNATTEND SERVICING COMMANDS:\r\n\r\n    /Apply-Unattend         - Applies an unattend file to an image.\r\n\r\n    EDGE SERVICING COMMANDS:\r\n\r\n    /Add-Edge               - Adds Edge to image.\r\n    /Add-EdgeBrowser        - Adds Edge browser to image.\r\n    /Add-EdgeWebView        - Adds Edge WebView to image.\r\n\r\n    PROVISIONING PACKAGE SERVICING COMMANDS:\r\n\r\n    /Get-ProvisioningPackageInfo - Gets the information of provisioning package.\r\n    /Add-ProvisioningPackage - Adds provisioning package.\r\n\r\n    WINDOWS EDITION SERVICING COMMANDS:\r\n\r\n    /Set-ProductKey         - Sets the product key of the offline image.\r\n    /Get-TargetEditions     - Displays a list of Windows editions that an image \r\n                                can be upgraded to.\r\n    /Get-CurrentEdition     - Displays the edition of the current image.\r\n    /Set-Edition            - Upgrades an image to a higher edition.\r\n\r\n    For more information about these servicing commands and their arguments,\r\n    specify a command immediately before /?.\r\n\r\n        Examples: \r\n            DISM.exe /Image:C:\\test\\offline /Apply-Unattend /?\r\n            DISM.exe /Image:C:\\test\\offline /Get-Features /?\r\n            DISM.exe /Online /Get-Drivers /?\r\n\r\nThus the rabbit hole deepins. \r\n\r\n\r\n---\r\n## Why Use DISM?\r\n\r\n### Repairing Windows\r\n\r\n**DISM** is used to repair or (un)install packages or to repair, install, or backup a windows image.\r\n\r\nLets dive into the world of `DISM /cleanup-image`.\r\n\r\nThanks to the help info, we know the following: \r\n\r\n    \r\n    Deployment Image Servicing and Management tool\r\n    Version: 10.0.22621.1\r\n\r\n    Image Version: 10.0.22621.963\r\n\r\n\r\n    /Cleanup-Image /RevertPendingActions \r\n\r\n    WARNING! You should use the /RevertPendingActions option only in a \r\n    system-recovery scenario to perform recovery operations on a Windows image \r\n    that did not boot. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /RevertPendingActions \r\n\r\n    /Cleanup-Image /spsuperseded [/hidesp] \r\n    Use /SPSuperseded to remove any backup files created during the installation \r\n    of a service pack. Use /HideSP to prevent the service pack from being listed \r\n    in the Installed Updates for the operating system. \r\n\r\n    WARNING! The service pack cannot be uninstalled after the /SPSuperseded \r\n    operation is completed. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /spsuperseded /hidesp \r\n\r\n    /Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} \r\n    Use /CheckHealth to check whether the image has been flagged as corrupted \r\n    by a failed process and whether the corruption can be repaired. \r\n    Use /ScanHealth to scan the image for component store corruption. \r\n    Use /RestoreHealth to scan the image for component store corruption, and \r\n    then perform repair operations automatically. \r\n    Use /Source with /RestoreHealth to specify the location of known good \r\n    versions of files that can be used for the repair. For more information on \r\n    specifying a source location, see \r\n    https://go.microsoft.com/fwlink/?LinkId=243077. \r\n    Use /LimitAccess to prevent DISM from contacting WU/WSUS. \r\n\r\n        Example: \r\n        DISM.exe /Online /Cleanup-Image /ScanHealth\r\n\r\n        DISM.exe /Image:c:\\offline /Cleanup-Image /RestoreHealth \r\n        /Source:c:\\test\\mount \r\n\r\n    /Cleanup-Image /StartComponentCleanup [/ResetBase [/Defer]]\r\n    Use /StartComponentCleanup to clean up the superseded components and reduce\r\n    the size of the component store. Use /ResetBase to reset the base of \r\n    superseded components, which can further reduce the component store size.\r\n    Use /Defer with /ResetBase to defer long-running cleanup operations to the \r\n    next automatic maintenance. \r\n\r\n    WARNING!  The installed Windows Updates cannot be uninstalled after the \r\n    /StartComponentCleanup with /ResetBase operation is completed. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /StartComponentCleanup\r\n\r\n    /Cleanup-Image /AnalyzeComponentStore \r\n    Use /AnalyzeComponentStore to create a report of the WinSxS component store.\r\n    For more information about the WinSxS report and how to use the information\r\n    provided in the report, see\r\n    https://go.microsoft.com/fwlink/?LinkId=293367. \r\n\r\n        Example: \r\n        DISM.exe /Image:C:\\test\\offline /Cleanup-Image /AnalyzeComponentStore\r\n\r\n\r\nBut what does this mean? \r\n\r\nWell let's take a look at one of the most used arguments. `DISM /Online /Cleanup-Image {/CheckHealth | /ScanHealth | /RestoreHealth} `\r\n\r\nIf you have had one of the many issues that exist with windows since 7 then there is a good chance you have seen this command. This uses the DISM tool on the \"Online\" windows image and the `Cleanup-Image` option. We then use the `/CheckHealth`, `/ScanHealth`, or `/RestoreHealth` servicing command to attempt to aqcuire information or attempt to fix the current windows image. ***This is a powerful tool.***\r\n\r\n\r\n #### CheckHealth\r\n \r\n > `DISM /Online /Cleanup-Image /CheckHealth`\r\n \r\n This is used to check the DISM version, image version, and weather or not the component store is currupted or repairable. This is one of the quickest ways of seeing if something is wrong with your current system. \r\n \r\n#### ScanHealth\r\n\r\n> `DISM /Online /Cleanup-Image /ScanHealth`\r\n\r\nThis is probably one of the most comman fix suggestions on the internet. Anything wonky with windows and people will suggest this as a quick fix. Why is this? Well, it works a small percentage of the time. \r\n\r\nWhat this does is scans the currently running windows image and checks for any issues that it can resolve. It can fix these issues by pulling the missing or broken dependencies from Microsoft. This option means not having to pull out installation media to attempt a fix of windows, or having to reinstall in many cases.\r\n\r\n#### RestoreHealth\r\n\r\n> `DISM /Online /Cleanup-Image /RestoreHealth\r\n\r\nThis is the powerful tool we mentioned above. This allows us to restore the missing or currupt files from a trusted source. Using this command will pull the needed files from Microsoft to repair your running version of Windows. This isn't a cure-all but it works for most system corruption issues.\r\n ";
						const data = {title:"What is DISM",description:"Deployment Image Servicing and Management",draft:false,category:"Windows"};
						const _internal = {
							type: 'content',
							filePath: "C:/Users/meatw/source/repos/brunscii/astro-blog-site/src/content/blog/APlusTerms/Windows/dism/whatIsDISM.md",
							rawData: undefined,
						};

export { _internal, body, collection, data, id, slug };
